/*
 * analytical_inverse.c
 *
 * Code generation for function 'analytical_inverse'
 *
 */

/* Include files */
#include "rt_nonfinite.h"
#include "SigFit.h"
#include "analytical_inverse.h"

/* Function Definitions */
void analytical_inverse(const double a[16], double inv_a[16])
{
  double det;
  int i3;

  /* http://www.cg.info.hiroshima-cu.ac.jp/~miyazaki/knowledge/teche23.html */
  memset(&inv_a[0], 0, sizeof(double) << 4);
  det = ((((((((((((((((((((((a[0] * a[5] * a[10] * a[15] + a[0] * a[9] * a[14] *
    a[7]) + a[0] * a[13] * a[6] * a[11]) + a[4] * a[1] * a[14] * a[11]) + a[4] *
    a[9] * a[2] * a[15]) + a[4] * a[13] * a[10] * a[3]) + a[8] * a[1] * a[6] *
    a[15]) + a[8] * a[5] * a[14] * a[3]) + a[8] * a[13] * a[2] * a[7]) + a[12] *
                      a[1] * a[10] * a[7]) + a[12] * a[5] * a[2] * a[11]) + a[12]
                    * a[9] * a[6] * a[3]) - a[0] * a[5] * a[14] * a[11]) - a[0] *
                  a[9] * a[6] * a[15]) - a[0] * a[13] * a[10] * a[7]) - a[4] *
                a[1] * a[10] * a[15]) - a[4] * a[9] * a[14] * a[3]) - a[4] * a
              [13] * a[2] * a[11]) - a[8] * a[1] * a[14] * a[7]) - a[8] * a[5] *
            a[2] * a[15]) - a[8] * a[13] * a[6] * a[3]) - a[12] * a[1] * a[6] *
          a[11]) - a[12] * a[5] * a[10] * a[3]) - a[12] * a[9] * a[2] * a[7];
  if (det != 0.0) {
    inv_a[0] = ((((a[5] * a[10] * a[15] + a[9] * a[14] * a[7]) + a[13] * a[6] *
                  a[11]) - a[5] * a[14] * a[11]) - a[9] * a[6] * a[15]) - a[13] *
      a[10] * a[7];
    inv_a[4] = ((((a[4] * a[14] * a[11] + a[8] * a[6] * a[15]) + a[12] * a[10] *
                  a[7]) - a[4] * a[10] * a[15]) - a[8] * a[14] * a[7]) - a[12] *
      a[6] * a[11];
    inv_a[8] = ((((a[4] * a[9] * a[15] + a[8] * a[13] * a[7]) + a[12] * a[5] *
                  a[11]) - a[4] * a[13] * a[11]) - a[8] * a[5] * a[15]) - a[12] *
      a[9] * a[7];
    inv_a[12] = ((((a[4] * a[13] * a[10] + a[8] * a[5] * a[14]) + a[12] * a[9] *
                   a[6]) - a[4] * a[9] * a[14]) - a[8] * a[13] * a[6]) - a[12] *
      a[5] * a[10];
    inv_a[1] = ((((a[1] * a[14] * a[11] + a[9] * a[2] * a[15]) + a[13] * a[10] *
                  a[3]) - a[1] * a[10] * a[15]) - a[9] * a[14] * a[3]) - a[13] *
      a[2] * a[11];
    inv_a[5] = ((((a[0] * a[10] * a[15] + a[8] * a[14] * a[3]) + a[12] * a[2] *
                  a[11]) - a[0] * a[14] * a[11]) - a[8] * a[2] * a[15]) - a[12] *
      a[10] * a[3];
    inv_a[9] = ((((a[0] * a[13] * a[11] + a[8] * a[1] * a[15]) + a[12] * a[9] *
                  a[3]) - a[0] * a[9] * a[15]) - a[8] * a[13] * a[3]) - a[12] *
      a[1] * a[11];
    inv_a[13] = ((((a[0] * a[9] * a[14] + a[8] * a[13] * a[2]) + a[12] * a[1] *
                   a[10]) - a[0] * a[13] * a[10]) - a[8] * a[1] * a[14]) - a[12]
      * a[9] * a[2];
    inv_a[2] = ((((a[1] * a[6] * a[15] + a[5] * a[14] * a[3]) + a[13] * a[2] *
                  a[7]) - a[1] * a[14] * a[7]) - a[5] * a[2] * a[15]) - a[13] *
      a[6] * a[3];
    inv_a[6] = ((((a[0] * a[14] * a[7] + a[4] * a[2] * a[15]) + a[12] * a[6] *
                  a[3]) - a[0] * a[6] * a[15]) - a[4] * a[14] * a[3]) - a[12] *
      a[2] * a[7];
    inv_a[10] = ((((a[0] * a[5] * a[15] + a[4] * a[13] * a[3]) + a[12] * a[1] *
                   a[7]) - a[0] * a[13] * a[7]) - a[4] * a[1] * a[15]) - a[12] *
      a[5] * a[3];
    inv_a[14] = ((((a[0] * a[13] * a[6] + a[4] * a[1] * a[14]) + a[12] * a[5] *
                   a[2]) - a[0] * a[5] * a[14]) - a[4] * a[13] * a[2]) - a[12] *
      a[1] * a[6];
    inv_a[3] = ((((a[1] * a[10] * a[7] + a[5] * a[2] * a[11]) + a[9] * a[6] * a
                  [3]) - a[1] * a[6] * a[11]) - a[5] * a[10] * a[3]) - a[9] * a
      [2] * a[7];
    inv_a[7] = ((((a[0] * a[6] * a[11] + a[4] * a[10] * a[3]) + a[8] * a[2] * a
                  [7]) - a[0] * a[10] * a[7]) - a[4] * a[2] * a[11]) - a[8] * a
      [6] * a[3];
    inv_a[11] = ((((a[0] * a[9] * a[7] + a[4] * a[1] * a[11]) + a[8] * a[5] * a
                   [3]) - a[0] * a[5] * a[11]) - a[4] * a[9] * a[3]) - a[8] * a
      [1] * a[7];
    inv_a[15] = ((((a[0] * a[5] * a[10] + a[4] * a[9] * a[2]) + a[8] * a[1] * a
                   [6]) - a[0] * a[9] * a[6]) - a[4] * a[1] * a[10]) - a[8] * a
      [5] * a[2];
    for (i3 = 0; i3 < 16; i3++) {
      inv_a[i3] /= det;
    }
  }
}

/* End of code generation (analytical_inverse.c) */
