<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">param</span>,<span class="var type1" id="S3T2U4">f</span>,<span class="var type1" id="S4T3U5">SC</span>,<span class="var type1" id="S5T3U6">result</span>]=SigFit(<span class="var type1" id="S6T2U9">x</span>,<span class="var type1" id="S7T2U10">ABSD</span>,<span class="var type1" id="S5T3U11">result</span>,<span class="var type1" id="S8T4U12">ini_param</span>,<span class="var type1" id="S4T3U13">SC</span>,<span class="var type1" id="S9T3U14">TC</span>,<span class="var type1" id="S10T3U15">HTC</span>,<span class="var type1" id="S11T3U16">SFC</span>,<span class="var type1" id="S12T5U17">perturbation</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% global TC HTC SFC perturbation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo " id="T3:U14"><span class="var type1" id="S13T3U20">ERR</span>=<span class="mxinfo " id="T3:U16">0</span></span>; <span class="mxinfo " id="T3:U17"><span class="var type1" id="S14T3U24">ERR2</span>=<span class="mxinfo " id="T3:U19">0</span></span>; <span class="mxinfo " id="T3:U20"><span class="var type1" id="S15T3U28">state</span>=<span class="mxinfo " id="T3:U22">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T1:U23"><span class="var type1" id="S2T1U32">param</span> = <span class="mxinfo " id="T6:U25">zeros(<span class="mxinfo " id="T3:U26">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T2:U27"><span class="var type1" id="S3T2U38">f</span> = <span class="mxinfo " id="T2:U29">zeros(<span class="mxinfo " id="T3:U30">length(<span class="var type1" id="S6T2U43">x</span>)</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="keyword">while</span> (<span class="mxinfo " id="T7:U32"><span class="var type1" id="S13T3U51">ERR</span>&lt;<span class="mxinfo " id="T3:U34">0.5</span></span>) || (<span class="mxinfo " id="T7:U35"><span class="var type1" id="S13T3U55">ERR</span>&gt;<span class="mxinfo " id="T3:U37">1.5</span></span>) || (<span class="mxinfo " id="T7:U38"><span class="var type1" id="S14T3U59">ERR2</span>&lt;<span class="mxinfo " id="T3:U40">0.5</span></span>) || (<span class="mxinfo " id="T7:U41"><span class="var type1" id="S15T3U63">state</span>==<span class="mxinfo " id="T3:U43">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U44"><span class="var type1" id="S4T3U68">SC</span>&gt;<span class="var type1" id="S10T3U69">HTC</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">        <span class="mxinfo " id="T3:U47"><span class="var type1" id="S5T3U72">result</span>=<span class="mxinfo " id="T3:U49">3</span></span>; <span class="keyword">break</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line">    [<span class="var type1" id="S2T1U78">param</span>, <span class="mxinfo " id="T3:U51">~</span>, <span class="var type1" id="S15T3U80">state</span>]=<span class="fcn" id="F242N4:B82">SigFitter_4para</span>(<span class="mxinfo " id="T8:U53"><span class="var type1" id="S6T2U84">x</span>(<span class="mxinfo " id="T9:U55"><span class="var type1" id="S4T3U86">SC</span>:<span class="var type1" id="S9T3U87">TC</span></span>)</span>,<span class="mxinfo " id="T8:U58"><span class="var type1" id="S7T2U89">ABSD</span>(<span class="mxinfo " id="T9:U60"><span class="var type1" id="S4T3U91">SC</span>:<span class="var type1" id="S9T3U92">TC</span></span>)</span>,<span class="var type1" id="S8T4U93">ini_param</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U64"><span class="mxinfo " id="T3:U65">abs(<span class="mxinfo " id="T3:U66"><span class="var type1" id="S2T1U100">param</span>(<span class="mxinfo " id="T3:U68">4</span>)</span>)</span>&gt;<span class="mxinfo " id="T3:U69">2</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">        [<span class="var type1" id="S2T1U106">param</span>, <span class="mxinfo " id="T3:U71">~</span>, <span class="var type1" id="S15T3U108">state</span>]=<span class="fcn" id="F242N4:B110">SigFitter_4para</span>(<span class="mxinfo " id="T8:U73"><span class="var type1" id="S6T2U112">x</span>(<span class="mxinfo " id="T9:U75"><span class="var type1" id="S4T3U114">SC</span>:<span class="var type1" id="S9T3U115">TC</span></span>)</span>,<span class="mxinfo " id="T8:U78"><span class="mxinfo " id="T8:U79"><span class="var type1" id="S7T2U118">ABSD</span>(<span class="mxinfo " id="T9:U81"><span class="var type1" id="S4T3U120">SC</span>:<span class="var type1" id="S9T3U121">TC</span></span>)</span>+<span class="mxinfo " id="T10:U84"><span class="var type1" id="S12T5U123">perturbation</span>(<span class="mxinfo " id="T11:U86"><span class="var type1" id="S4T3U125">SC</span>:<span class="var type1" id="S9T3U126">TC</span></span>)</span></span>,<span class="var type1" id="S8T4U127">ini_param</span>);  </span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">    <span class="mxinfo " id="T2:U90"><span class="var type1" id="S3T2U130">f</span>=<span class="mxinfo " id="T2:U92"><span class="fcn" id="F271N10:B132">sig</span>(<span class="var type1" id="S2T1U133">param</span>,<span class="var type1" id="S6T2U134">x</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">    <span class="comment">%---------(B) check suitability --------</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo " id="T3:U95"><span class="var type1" id="S21T3U137">min_sig</span>=<span class="mxinfo " id="T3:U97">min(<span class="mxinfo " id="T3:U98"><span class="var type1" id="S3T2U141">f</span>(<span class="var type1" id="S9T3U142">TC</span>)</span>,<span class="mxinfo " id="T3:U101"><span class="var type1" id="S3T2U144">f</span>(<span class="mxinfo " id="T12:U103">1</span>)</span>)</span></span>; <span class="mxinfo " id="T3:U104"><span class="var type1" id="S23T3U148">max_sig</span>=<span class="mxinfo " id="T3:U106">max(<span class="mxinfo " id="T3:U107"><span class="var type1" id="S3T2U152">f</span>(<span class="var type1" id="S9T3U153">TC</span>)</span>,<span class="mxinfo " id="T3:U110"><span class="var type1" id="S3T2U155">f</span>(<span class="mxinfo " id="T12:U112">1</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">    <span class="mxinfo " id="T3:U113"><span class="var type1" id="S25T3U159">min_ABSD</span>=<span class="mxinfo " id="T3:U115">min(<span class="mxinfo " id="T8:U116"><span class="var type1" id="S7T2U163">ABSD</span>(<span class="mxinfo " id="T9:U118"><span class="var type1" id="S11T3U165">SFC</span>:<span class="var type1" id="S9T3U166">TC</span></span>)</span>)</span></span>; <span class="mxinfo " id="T3:U121"><span class="var type1" id="S26T3U169">max_ABSD</span>=<span class="mxinfo " id="T3:U123">max(<span class="mxinfo " id="T8:U124"><span class="var type1" id="S7T2U173">ABSD</span>(<span class="mxinfo " id="T9:U126"><span class="var type1" id="S11T3U175">SFC</span>:<span class="var type1" id="S9T3U176">TC</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">    <span class="mxinfo " id="T3:U129"><span class="var type1" id="S13T3U179">ERR</span>=<span class="mxinfo " id="T3:U131">(<span class="mxinfo " id="T3:U132"><span class="var type1" id="S23T3U183">max_sig</span>-<span class="var type1" id="S21T3U184">min_sig</span></span>)/(<span class="mxinfo " id="T3:U135"><span class="var type1" id="S26T3U187">max_ABSD</span>-<span class="var type1" id="S25T3U188">min_ABSD</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">    <span class="mxinfo " id="T13:U138"><span class="var type1" id="S27T13U191">ovitv</span>=<span class="mxinfo " id="T13:U140"><span class="fcn" id="F294N2:B193">OverlappingInterval</span>(<span class="mxinfo " id="T13:U141">[<span class="var type1" id="S21T3U196">min_sig</span> <span class="var type1" id="S23T3U197">max_sig</span>]</span>,<span class="mxinfo " id="T13:U144">[<span class="var type1" id="S25T3U200">min_ABSD</span> <span class="var type1" id="S26T3U201">max_ABSD</span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">    <span class="mxinfo " id="T3:U147"><span class="var type1" id="S14T3U204">ERR2</span>=<span class="mxinfo " id="T3:U149">(<span class="mxinfo " id="T3:U150"><span class="mxinfo " id="T3:U151"><span class="var type1" id="S27T13U209">ovitv</span>(<span class="mxinfo " id="T12:U153">2</span>)</span>-<span class="mxinfo " id="T3:U154"><span class="var type1" id="S27T13U212">ovitv</span>(<span class="mxinfo " id="T3:U156">1</span>)</span></span>)/(<span class="mxinfo " id="T3:U157"><span class="var type1" id="S26T3U216">max_ABSD</span>-<span class="var type1" id="S25T3U217">min_ABSD</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line">    <span class="comment">%---------(E) check sutability --------</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">    <span class="mxinfo " id="T3:U160"><span class="var type1" id="S4T3U220">SC</span>=<span class="mxinfo " id="T3:U162"><span class="var type1" id="S4T3U222">SC</span>+<span class="mxinfo " id="T3:U164">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
</body>
</html>
